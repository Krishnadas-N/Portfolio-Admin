<div class="container mx-auto p-4 lg:p-8 max-w-5xl">
  
  <!-- Header Actions -->
  <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-8 sticky top-0 z-20 bg-base-100/80 backdrop-blur-md py-4 -mx-4 px-4 sm:mx-0 sm:px-0 border-b border-base-200 sm:border-none">
    <div>
      <h1 class="text-3xl font-bold text-base-content tracking-tight">{{ isEditMode() ? 'Edit Skill' : 'Add New Skill' }}</h1>
      <p class="text-base-content/60 text-sm mt-1">Define your technical expertise.</p>
    </div>
    <div class="flex gap-3 w-full sm:w-auto">
      <button type="button" (click)="onCancel()" class="btn btn-ghost flex-1 sm:flex-none">Cancel</button>
      <button type="button" (click)="onSubmit()" [disabled]="skillForm.invalid || isSubmitting()" class="btn btn-primary flex-1 sm:flex-none shadow-lg shadow-primary/20">
        <span *ngIf="isSubmitting()" class="loading loading-spinner loading-xs"></span>
        <i class="fa-regular fa-floppy-disk mr-2" *ngIf="!isSubmitting()"></i>
        {{ isEditMode() ? 'Save Changes' : 'Add Skill' }}
      </button>
    </div>
  </div>

  <form [formGroup]="skillForm" class="grid grid-cols-1 md:grid-cols-3 gap-8">
    
    <!-- Left Column (Main Content) -->
    <div class="md:col-span-2 space-y-8">
      
      <!-- Basic Info -->
      <div class="card bg-base-100 shadow-sm border border-base-200">
        <div class="card-body p-6">
          <h2 class="card-title text-lg flex items-center gap-2 mb-4">
            <div class="w-8 h-8 rounded-lg bg-primary/10 flex items-center justify-center text-primary">
              <i class="fa-solid fa-code"></i>
            </div>
            Skill Details
          </h2>
          
          <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
            <div class="form-control">
              <label class="label"><span class="label-text font-medium">Skill Name</span></label>
              <input type="text" formControlName="name" placeholder="e.g. Angular" 
                     class="input input-bordered w-full focus:input-primary transition-all" 
                     [class.input-error]="f['name'].touched && f['name'].invalid" />
              <label class="label" *ngIf="f['name'].touched && f['name'].invalid">
                <span class="label-text-alt text-error">Name is required</span>
              </label>
            </div>

            <div class="form-control">
              <label class="label"><span class="label-text font-medium">Category</span></label>
              <input type="text" formControlName="category" placeholder="e.g. framework" 
                     class="input input-bordered w-full focus:input-primary transition-all" 
                     [class.input-error]="f['category'].touched && f['category'].invalid" />
              <label class="label" *ngIf="f['category'].touched && f['category'].invalid">
                <span class="label-text-alt text-error">Category is required</span>
              </label>
            </div>
          </div>

          <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mt-2">
             <div class="form-control">
               <label class="label"><span class="label-text font-medium">Level</span></label>
               <select formControlName="level" class="select select-bordered w-full">
                  <option value="beginner">Beginner</option>
                  <option value="intermediate">Intermediate</option>
                  <option value="advanced">Advanced</option>
                  <option value="expert">Expert</option>
               </select>
             </div>
             
             <div class="form-control">
               <label class="label"><span class="label-text font-medium">Years of Experience</span></label>
               <input type="number" formControlName="yearsOfExperience" min="0" class="input input-bordered w-full" />
             </div>
          </div>

          <div class="form-control mt-4">
             <label class="label"><span class="label-text font-medium">Description</span></label>
             <textarea formControlName="description" class="textarea textarea-bordered h-24" placeholder="Brief description..."></textarea>
          </div>
        </div>
      </div>

    </div>

    <!-- Right Column (Sidebar) -->
    <div class="space-y-8">
      
      <!-- Icon/Logo -->
      <div class="card bg-base-100 shadow-sm border border-base-200">
        <div class="card-body p-6">
          <h2 class="card-title text-base mb-4 text-base-content/70 uppercase tracking-wide font-bold text-xs">Icon & Color</h2>
          
          <div class="form-control">
             <div class="border-2 border-dashed border-base-300 rounded-xl p-6 text-center hover:border-primary/50 hover:bg-base-200/30 transition-all cursor-pointer relative group bg-base-50/50 flex flex-col items-center justify-center min-h-[140px]">
                <input type="file" accept="image/*" (change)="onImageSelected($event)" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10" />
                
                <div class="flex flex-col items-center gap-2 text-base-content/60" *ngIf="!skillForm.get('icon')?.value">
                   <div class="w-12 h-12 rounded-full bg-base-200 flex items-center justify-center mb-1 group-hover:bg-primary/10 group-hover:text-primary transition-colors">
                      <i class="fa-regular fa-image text-xl"></i>
                   </div>
                   <span class="font-medium text-sm">Upload Icon</span>
                </div>
                
                <div *ngIf="skillForm.get('icon')?.value" class="relative w-20 h-20">
                   <img [src]="skillForm.get('icon')?.value" class="w-full h-full object-contain" />
                   <button type="button" (click)="$event.stopPropagation(); skillForm.get('icon')?.setValue('')" 
                           class="absolute -top-2 -right-2 z-20 btn btn-circle btn-xs btn-error text-white shadow-lg opacity-0 group-hover:opacity-100 transition-opacity">
                      <i class="fa-solid fa-xmark"></i>
                   </button>
                </div>
             </div>
             <div class="divider text-xs text-base-content/30 my-4 font-medium">OR URL</div>
             <input type="text" formControlName="icon" placeholder="https://..." class="input input-sm input-bordered w-full" />
          </div>

          <div class="form-control mt-4">
             <label class="label"><span class="label-text font-medium">Color</span></label>
             <div class="flex gap-2 items-center">
                <input type="color" formControlName="color" class="w-10 h-10 p-0 border-0 rounded-lg cursor-pointer" />
                <input type="text" formControlName="color" class="input input-bordered input-sm flex-1 font-mono uppercase" />
             </div>
          </div>
        </div>
      </div>

      <!-- Visibility -->
      <div class="card bg-base-100 shadow-sm border border-base-200">
        <div class="card-body p-6">
          <h2 class="card-title text-base mb-4 text-base-content/70 uppercase tracking-wide font-bold text-xs">Settings</h2>
          
          <div class="space-y-2">
            <div class="form-control">
              <label class="label cursor-pointer p-0 hover:bg-base-200 rounded-lg p-2 -mx-2 transition-colors">
                <div class="flex flex-col">
                  <span class="label-text font-medium">Active</span>
                  <span class="label-text-alt text-base-content/50">Show on portfolio</span>
                </div>
                <input type="checkbox" formControlName="isActive" class="toggle toggle-success toggle-sm" />
              </label>
            </div>
          </div>
        </div>
      </div>

    </div>
  </form>
</div>
